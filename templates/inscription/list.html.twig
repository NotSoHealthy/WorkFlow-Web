{% extends 'layout.html.twig' %}
{% block stylesheets %}
    {{ parent() }}
    <style>
        h1 {
            text-align: center;
            font-size: 2rem;
            margin-bottom: 1rem;
        }
        .custom-btn {
            padding: 10px;
            text-decoration: none;
            font-size:20px;
            color: black;
            border: none;
            border-radius: 10px;
            transition: all 0.2s ease;
          }
  
          .custom-btn:hover {
            background-color: #0f2d3b;
            box-shadow: 0 4px 10px rgba(20, 60, 78, 0.4);
            color: #fff;
            text-decoration: none;
            transform: translateY(-1px);
          }
          .custom-btn .material-symbols-outlined {
            font-size: 18px;
          }
          .sidenav {
            position: fixed;
            height: 100%;
            overflow-y: auto;
            width: 13rem;
          }
          .main-content {
            margin-left: 13rem;
           
        }
    </style>        
{% endblock %}
{% block title %}Liste des Inscriptions{% endblock %}

{% block main %}
<main class="main-content">
<h1>Liste des Inscriptions</h1>

<a href="{{ path('app_formation_list') }}" class="custom-btn"><<</a>

<div class="container mt-4">
    {% for inscription in pagination %}
      <div class="card mb-3 shadow-sm border-0 mx-auto" style="max-width: 700px;">
        <div class="card-body">
          <h5 class="card-title mb-2">{{ inscription.user.firstName }} {{ inscription.user.lastName }}</h5>
          <p class="card-text mb-1">
            <strong>Formation : </strong> {{ inscription.formation.title }}<br>
            <strong>Date : </strong> {{ inscription.dateRegistration|date('Y-m-d') }}
          </p>
  
          <div class="d-flex justify-content-end gap-2">
            {% if is_granted('ROLE_RESPONSABLE') %}
              <form action="{{ path('app_inscription_edit', { id: inscription.id }) }}" method="POST" class="mb-0">
                <select name="status" class="form-select form-select-sm" onchange="this.form.submit()">
                  <option value="en attente" {{ inscription.status == 'en attente' ? 'selected' : '' }} disabled hidden>en attente</option>
                  <option value="validé" {{ inscription.status == 'validé' ? 'selected' : '' }}>validé</option>
                  <option value="refusé" {{ inscription.status == 'refusé' ? 'selected' : '' }}>refusé</option>
                </select>
              </form>
            {% endif %}
  
            {% if is_granted('ROLE_USER') and not is_granted('ROLE_RESPONSABLE') %}
              <span class="badge 
                {% if inscription.status == 'validé' %}bg-success
                {% else %}bg-warning text-dark
                {% endif %}">
                {{ inscription.status|capitalize }}
              </span>
            {% endif %}
          </div>
        </div>
      </div>
    {% else %}
      <div class="alert alert-info">No registrations found.</div>
    {% endfor %}
  </div>
  
<div class="d-flex justify-content-center mt-4">
    {{ knp_pagination_render(pagination, '@KnpPaginator/Pagination/bootstrap_v5_pagination.html.twig') }}
</div>
</main>
{% endblock %}

